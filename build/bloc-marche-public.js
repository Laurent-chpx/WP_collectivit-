(()=>{"use strict";const e=window.React,t=window.wp.blocks,l=window.wp.blockEditor,a=window.wp.components;(0,t.registerBlockType)("wpcollectivites/marche-public",{title:"Marché Public",icon:"megaphone",category:"wp-collectivites",keywords:["marché","public","appel","offre"],attributes:{intitule:{type:"string",default:""},date_publication:{type:"string",default:""},date_cloture:{type:"string",default:""},type_marche:{type:"string",default:""},lien:{type:"string",default:""},profil_acheteur:{type:"string",default:""},avis_complet:{type:"string",default:""}},edit:({attributes:t,setAttributes:r,className:n})=>{const{intitule:c,date_publication:o,date_cloture:i,type_marche:p,lien:u,profil_acheteur:s,avis_complet:m}=t;return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(l.InspectorControls,null,(0,e.createElement)(a.PanelBody,{title:"Configuration du marché public",initialOpen:!0},(0,e.createElement)(a.TextControl,{label:"Date de publication",help:"Format : AAAA-MM-JJ",value:o,onChange:e=>r({date_publication:e}),type:"date"}),(0,e.createElement)(a.TextControl,{label:"Date et heure de clôture",help:"Format : AAAA-MM-JJ HH:MM",value:i,onChange:e=>r({date_cloture:e}),type:"datetime-local"}),(0,e.createElement)(a.TextControl,{label:"Type de marché",value:p,onChange:e=>r({type_marche:e}),placeholder:"Ex: Travaux, Services, Fournitures..."}),(0,e.createElement)(a.TextControl,{label:"Lien vers la plateforme",value:u,onChange:e=>r({lien:e}),type:"url",placeholder:"https://..."}),(0,e.createElement)(a.TextControl,{label:"Profil acheteur",value:s,onChange:e=>r({profil_acheteur:e})}))),(0,e.createElement)("div",{className:`${n} bloc-marche-public`},(0,e.createElement)(l.RichText,{tagName:"h3",value:c,onChange:e=>r({intitule:e}),placeholder:"Titre du marché...",allowedFormats:[]}),o&&(0,e.createElement)("p",null,(0,e.createElement)("strong",null,"Date de publication : "),o),i&&(0,e.createElement)("p",null,(0,e.createElement)("strong",null,"Date de clôture : "),new Date(i).toLocaleString("fr-FR"),new Date(i)<new Date&&(0,e.createElement)("span",{style:{color:"red",marginLeft:"10px"}},"Marché clôturé")),p&&(0,e.createElement)("p",null,(0,e.createElement)("strong",null,"Type de marché : "),p),(0,e.createElement)("div",{className:"wp-block-buttons"},(0,e.createElement)("div",{className:"wp-block-button"},(0,e.createElement)("span",{className:"wp-block-button__link"},"En savoir plus"))),(0,e.createElement)("div",{style:{marginTop:"20px",padding:"10px",border:"1px dashed #ccc",backgroundColor:"#f5f5f5"}},(0,e.createElement)("p",{style:{marginTop:0,fontWeight:"bold",color:"#666"}},'Avis complet (visible après clic sur "En savoir plus") :'),u&&(0,e.createElement)("p",null,(0,e.createElement)("strong",null,"Lien vers la plateforme : "),(0,e.createElement)("a",{href:u,target:"_blank",rel:"noopener noreferrer"},u)),s&&(0,e.createElement)("p",null,(0,e.createElement)("strong",null,"Profil acheteur : "),s),(0,e.createElement)(l.RichText,{tagName:"div",value:m,onChange:e=>r({avis_complet:e}),placeholder:"Saisissez ici l'avis complet du marché...",allowedFormats:["core/bold","core/italic","core/link"]}))))},save:()=>null})})();